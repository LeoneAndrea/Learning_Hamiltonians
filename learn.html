
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Learning procedure &#8212; Learning_Hamiltonians 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Example" href="intro.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="learning-procedure">
<span id="learn"></span><h1>Learning procedure<a class="headerlink" href="#learning-procedure" title="Permalink to this heading">¶</a></h1>
<section id="problem-description">
<h2>Problem description<a class="headerlink" href="#problem-description" title="Permalink to this heading">¶</a></h2>
<p>We work with numerically generated training trajectories that we denote by</p>
<div class="math notranslate nohighlight">
\[\begin{align}
    \{(x_i,y_i^2,...,y_i^M)\}_{i=1,...,N}.
\end{align}\]</div>
<p>To obtain an approximation of the Hamiltonian <span class="math notranslate nohighlight">\(H\)</span>, we define a parametric model <span class="math notranslate nohighlight">\(H_{\Theta}\)</span> and
look for a <span class="math notranslate nohighlight">\(\Theta\)</span> so that the trajectories generated by <span class="math notranslate nohighlight">\(H_{\Theta}\)</span> resemble the given ones.
<span class="math notranslate nohighlight">\(H_{\Theta}\)</span> in principle can be any parametric function depending on the parameters <span class="math notranslate nohighlight">\(\Theta\)</span>.
In  our approach, <span class="math notranslate nohighlight">\(\Theta\)</span> will collect a factor of the mass matrix and the weights of a neural network,
as described below. We use some numerical one-step method <span class="math notranslate nohighlight">\(\Psi_{X_{H_{\Theta}}}^{\Delta t}\)</span> to generate
the trajectories</p>
<div class="math notranslate nohighlight">
\[\begin{align}
    \hat{y}_i^j(\Theta) :=\Psi_{X_{H_{\Theta}}}^{\Delta t}(\hat{y}_i^{j-1}(\Theta)),\quad \hat{y}_i^1(\Theta) := x_i, \quad j=2,\dots,M, \; i=1,\dots,N.
\end{align}\]</div>
<p>We then optimize a loss function measuring the distance between the given trajectories <span class="math notranslate nohighlight">\(y^j_i\)</span> and the generated
ones <span class="math notranslate nohighlight">\(\hat{y}_i^j\)</span>, defined as</p>
<div class="math notranslate nohighlight">
\[\begin{align}
    \mathcal{L}(\Theta):=\frac{1}{2n}\frac{1}{NM}\sum_{i=1}^N\mathcal{L}_i(\Theta) = \frac{1}{2n}\frac{1}{NM}\sum_{i=1}^N\sum_{j=1}^M \|\hat{y}_i^j(\Theta)- y_i^j\|^2,
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\|\cdot\|\)</span> is the Euclidean metric of <span class="math notranslate nohighlight">\(\mathbb{R}^{2n}\)</span>. This is implemented with the PyTorch
<span class="math notranslate nohighlight">\(\texttt{MSELoss}\)</span> loss function. Such a training procedure resembles the one of Recurrent Neural Networks (RNNs),
as shown for the forward pass of a single training trajectory in the following figure.</p>
<figure class="align-default" id="id1">
<img alt="_images/RNN_Diagram.png" src="_images/RNN_Diagram.png" />
<figcaption>
<p><span class="caption-text">Figure 1. Forward pass of an input training trajectory <span class="math notranslate nohighlight">\((x_i,y_i^2,...,y_i^M)\)</span>. The picture highlights the resemblance to an unrolled version of a Recurrent Neural Network. The network outputs <span class="math notranslate nohighlight">\((\hat{y}_i^2,…,\hat{y}_i^M)\)</span>.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Indeed, the weight sharing principle of RNNs is reproduced by the time steps in the numerical integrator which are all
based on the same approximation of the Hamiltonian, and hence on the same weights <span class="math notranslate nohighlight">\(\Theta\)</span>. In Algorithm WRITE ALGORITHM
we report one training epoch for a batch of data points…</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Learning_Hamiltonians</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Example</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Learning procedure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problem-description">Problem description</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="intro.html" title="previous chapter">Example</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Elena Celledoni, Andrea Leone, Davide Murari, Brynjulf Owren.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/learn.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>